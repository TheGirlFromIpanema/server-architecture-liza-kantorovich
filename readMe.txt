В чем суть проблемы я не знаю, похоже на то что она просто не успевала записать данные :)
Сначала заккоментила функцию по чтению, чтобы проверить что проблема в функции записи и где она файл создаст.
Я подумала, раз уж у нас асинхронная функция и мы вызываем ее через await,
то надо в самой функции сделать Promise,
потому что она может быть сразу прыгает на return "ok" и мы не успеваем записать данные в файл.
До этого рандомные флаги пробовала, но не помогло. В итоге вообще без флага работает.
Возможно вместо Promise надо было просто перед вызовом ws.write поставить await.
Зато с Promise легче отследить ошибку и записать ее в логи

Еще перенесла ws.end() в самый конец, чтобы точно поток закрывал.
И изменила создание даты в логере, чтобы было израильское время...
